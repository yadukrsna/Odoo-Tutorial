<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>
        <record id="hotel_management_accommodation_list_view" model="ir.ui.view">
            <field name="name">hotel.management.accommodation.list</field>
            <field name="model">hotel.management.accommodation</field>
            <field name="arch" type="xml">
                <list default_order="check_in asc"
                      decoration-danger="date_expected==context_today().strftime('%Y-%m-%d') and state=='check in'">
                    <field name="name"/>
                    <field name="room_id"/>
                    <field name="guest_id"/>
                    <field name="bed_type"/>
                    <field name="facility_id" options="{'color_field': 'color'}" widget="many2many_tags"/>
                    <field name="website_id" decoration-success="1" widget="badge"/>
                </list>
            </field>
        </record>

        <record id="hotel_management_accommodation_form_view" model="ir.ui.view">
            <field name="name">hotel.management.accommodation.form</field>
            <field name="model">hotel.management.accommodation</field>
            <field name="arch" type="xml">
                <form string="Accommodation">
                    <header>
                        <button name="check_in_action" type="object" string="Check In" class="btn-primary"
                                invisible="state=='check in' or state=='check out' or state=='cancel'"/>
                        <button name="check_out_action" type="object" string="Check Out"
                                invisible="state=='draft' or state=='check out' or state=='cancel'"/>
                        <button name="action_cancel" type="object" string="Cancel"
                                invisible="state=='check in' or state=='check out' or state=='cancel'"/>
                        <field name="state" widget="statusbar"
                               statusbar_visible="draft, check in, check out, cancel"/>
                    </header>
                    <sheet>
                        <widget name="web_ribbon" title="Paid" invisible="not payment_status == 'paid'"/>
                        <div name="button_box" position="inside">
                            <button class="oe_stat_button" type="object" icon="fa-dollar" string='Invoice'
                                    name="action_view_invoice" invisible="state!='check out'"/>
                            <button class="oe_stat_button" type="object" icon="fa-cutlery"
                                    name="action_order_food" invisible="state!='check in'">
                                <field name="count" string='Order Food' widget="statinfo"/>
                            </button>
                        </div>
                        <h1>
                            <field name="name"/>

                        </h1>
                        <group>
                            <group>
                                <field name="guest_id" options="{'no_create':False}" context="{'show_address':1}"
                                       readonly="state=='check in' or state == 'check out'"/>
                                <field name="guest_number" readonly="state=='check in' or state == 'check out'"/>
                                <field name="check_in" readonly="state=='check in' or state=='check out'"/>
                                <field name="expected_days" invisible="state=='cancel' or state=='check out'"/>
                                <field name="expected_date" invisible="state=='cancel' or state=='check out'"/>
                                <field name="check_out" readonly="state=='check out'"/>
                            </group>
                            <group>
                                <field name="bed_type" readonly="state=='check in' or state == 'check out'"/>
                                <field name="room_domain" invisible="1"/>
                                <field name="room_id" domain="room_domain" options="{'no_create': True}"
                                       readonly="state == 'check in' or state == 'check out'"/>
                                <field name="facility_id" options="{'no_create':True, 'color_field': 'color'}"
                                       widget="many2many_tags" readonly="state=='check in' or state == 'check out'"/>
                                <field name="id_proof"/>
                                <field name="id_number" invisible="id_proof==False"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Other Guests" invisible="guest_number &lt; 2">
                                <field name="other_guest_ids" readonly="state=='check in' or state == 'check out'">
                                    <list editable="bottom">
                                        <field name="partner_id"/>
                                        <field name="partner_gender"/>
                                        <field name="partner_age"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Payment">
                                <field name="payment_ids">
                                    <list create="false">
                                        <field name="product_id"/>
                                        <field name="currency_id" optional="hide"/>
                                        <field name="quantity"/>
                                        <field name="uom_id"/>
                                        <field name="unit_price"/>
                                        <field name="subtotal"/>
                                    </list>
                                </field>
                                <div class="o_group row align-items-start mt-2 mt-md-0">
                                    <div class="o_inner_group oe_subtotal_footer d-flex order-0 order-lg-1 flex-column
                                     fw-bold">
                                        <h3>Total:</h3>
                                        <field name="currency_id" invisible="1"/>
                                        <field name="total_amount" readonly="1"/>
                                    </div>
                                </div>
                            </page>
                        </notebook>
                    </sheet>
                    <chatter/>
                </form>
            </field>
        </record>

        <record id="hotel_management_accommodation_pivot_view" model="ir.ui.view">
            <field name="name">hotel.management.accommodation.pivot</field>
            <field name="model">hotel.management.accommodation</field>
            <field name="arch" type="xml">
                <pivot string="Hotel Accommodations" display_quantity="0" disable_linking="1" stacked="1">
                    <field name="name" type="row"/>
                    <field name="room_id" type="col"/>
                    <field name="guest_id" type="col"/>
                    <field name="total_amount" type="measure"/>
                </pivot>
            </field>
        </record>

        <record id="hotel_management_accommodation_kanban_view" model="ir.ui.view">
            <field name="name">hotel.management.accommodation.kanban</field>
            <field name="model">hotel.management.accommodation</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_mobile" sample="1">
                    <templates>
                        <t t-name="card">
                            <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                                <div class="row">
                                    <div>
                                        <strong>
                                            <field name="name"/>
                                        </strong>
                                    </div>
                                </div>
                                <div>ROOM :
                                    <field name="room_id"/>
                                </div>
                                <div>GUEST :
                                    <field name="guest_id"/>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <record id="hotel_management_accommodation_graph_view" model="ir.ui.view">
            <field name="name">hotel.management.accommodation.graph</field>
            <field name="model">hotel.management.accommodation</field>
            <field name="arch" type="xml">
                <graph string="Accommodation" disable_linking="1" stacked="1" cumulated="1"
                       cumulated_start="2025-01-01">
                    <field name="name" type="row"/>
                    <field name="room_id" type="col"/>
                    <field name="total_amount" type="measure"/>
                </graph>
            </field>
        </record>

        <record id="hotel_management_accommodation_activity_view" model="ir.ui.view">
            <field name="name">hotel.management.accommodation.activity</field>
            <field name="model">hotel.management.accommodation</field>
            <field name="arch" type="xml">
                <activity string="Accommodation">
                    <templates>
                        <div t-name="activity-box">
                            <div>
                                <field name="name"/>
                            </div>
                        </div>
                    </templates>
                </activity>
            </field>
        </record>

        <record id="hotel_management_accommodation_calendar_view" model="ir.ui.view">
            <field name="name">hotel.management.accommodation.calendar</field>
            <field name="model">hotel.management.accommodation</field>
            <field name="arch" type="xml">
                <calendar string="Hotel Accommodation" date_start="check_in" date_stop="check_out"
                          all_day="check_in" scales="day,week,month,year" hide_date="0" hide_time="0" create="0"
                          edit="0" delete="0" event_open_popup="true" mode="month" color="name"
                          quick_create="false">
                    <field name="name"/>
                </calendar>
            </field>
        </record>

        <record id="hotel_management_accommodation_search_view" model="ir.ui.view">
            <field name="name">hotel.management.accommodation.search</field>
            <field name="model">hotel.management.accommodation</field>
            <field name="arch" type="xml">
                <search>
                    <field name="room_id"/>
                    <field name="guest_id"/>
                    <field name="name"/>
                    <filter string="Current" name="current_accommodations" domain="[('state', '!=', 'cancel')]"/>
                    <filter string="Archived" name="archive" domain="[('active', '=', False)]"/>
                    <filter string="Expected Check Out" name="expected_check_out"
                    domain="['&amp;', ('state', '=' , 'check in'),
                             ('date_expected', '=', context_today().strftime('%Y-%m-%d'))]"/>
                    <filter string="Rooms" name="room" context="{'group_by': 'room_id'}"/>
                    <filter string="Bed Type" name="bed_type" context="{'group_by': 'bed_type'}"/>
                    <filter string="Facility" name="facility" context="{'group_by': 'facility_id'}"/>
                    <filter string="Check In" name="check_in" domain="[('state', '=', 'check in')]"/>
                    <filter string="Checked Out Today" name="check_out_today"
                            domain="['&amp;', ('state', '=' , 'check out'),('check_out', '=',
                             context_today().strftime('%Y-%m-%d'))]"/>
                    <filter string="Check Out Tomorrow" name="check_out_tomorrow"
                            domain="[('date_expected', '=',
                             (context_today() + relativedelta(days=1)).strftime('%%Y-%%m-%%d'))]"/>
                </search>
            </field>
        </record>

        <record id="action_hotel_management_accommodation" model="ir.actions.act_window">
            <field name="name">Accommodation</field>
            <field name="res_model">hotel.management.accommodation</field>
            <field name="view_mode">list,form,kanban,pivot,graph,calendar,activity,gantt</field>
            <field name="context">{'search_default_current_accommodations':True}</field>
        </record>
    </data>
</odoo>
